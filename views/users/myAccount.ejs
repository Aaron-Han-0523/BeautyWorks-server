<!DOCTYPE html>
<html lang="ko">

<head>
  <%- include ("../partials/header.ejs") %>
</head>

<body class="layout-boxed">

  <%- include ("../partials/loader.ejs") %>

    <%- include ("../partials/client-nav.ejs") %>
      <%- include ("../partials/chatMark.ejs") %>

        <!--  BEGIN MAIN CONTAINER  -->
        <div class="main-container" id="container">

          <div class="overlay"></div>
          <div class="search-overlay"></div>

          <%- include ("../partials/client-sidebar.ejs") %>

            <!--  BEGIN CONTENT AREA  -->
            <div id="content" class="main-content">
              <div class="layout-px-spacing">

                <div class="middle-content container-xxl p-0">

                  <!-- BREADCRUMB -->
                  <div class="row px-3">
                    <div class="breadcrumb align-items-start d-flex pt-3 br-20">
                      <div class="p-1 col-3">
                        <h5><strong>
                            <%= __('MyAccount') %>
                          </strong></h5>
                      </div>
                      <div class="p-1 flex-grow-1">
                        <div>
                          <a href="<%= codezip.url.users.myPage %>">
                            <img style="width: 25px;" src="\images\icon\down-arrow-svgrepo-com.svg">
                          </a>
                        </div>
                      </div>
                      <div class="p-1">
                        <h5>
                          <%= __('LogOut') %>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <!-- CONTENT AREA -->
                  <div class="row layout-top-spacing">
                    <div class="col-xl-12 col-lg-12 col-sm-12  layout-spacing">
                      <div class="widget-content widget-content-area br-20 py-5 px-5">

                        <form id="userAccount" class="px-3 mx-3" method="post" enctype="multipart/form-data">
                          <div class="form-group">
                            <div class="row">
                              <div class="col-6 col-md-4">
                                <h6>
                                  <%= __('users.myAccount.label.ProfileImage') %>
                                </h6>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-6 col-md-4">
                                <img id="profileImage" class="br-20" style="height: 200px;" src="/<%= user.profileImagePath %>">
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-6 col-md-4 mt-2">
                                <label class="btn mb-0 col-12" for="profileImagePath">
                                  <div class="mt-1">
                                    <%= __('users.myAccount.btn.UploadImage') %>
                                  </div>
                                </label>
                                <input type="file" name="profileImagePath" id="profileImagePath" hidden>
                              </div>
                              <div class="row">
                                <div class="col-6 col-md-4 mt-2 text-center">
                                  <a href="javascript:void(0);" onclick="removeImage();">
                                    <h6>
                                      <%= __('users.myAccount.btn.RemoveImage') %>
                                    </h6>
                                  </a>
                                </div>
                              </div>
                            </div>

                            <div class="form-group layout-top-spacing">
                              <div class="row">
                                <div>
                                  <h6>
                                    <%= __('users.myAccount.label.DisplayName') %>
                                  </h6>
                                </div>
                                <div class="row">
                                  <div class="col-6 col-md-4">
                                    <input class="form-control" type="text" value="<%= user.firstName %>" disabled>
                                  </div>
                                  <div class="col-6 col-md-4">
                                    <input class="form-control" type="text" value="<%= user.lastName %>" disabled>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <div class="form-group layout-top-spacing">
                              <div class="row">
                                <div>
                                  <h6>
                                    <%= __('users.myAccount.label.CompanyName') %>
                                  </h6>
                                </div>
                                <div class="row">
                                  <div class="col-6 col-md-4">
                                    <input class="form-control" type="text" name="companyName"
                                      value="<%= user.companyName %>">
                                  </div>
                                </div>
                              </div>
                            </div>

                            <div class="form-group layout-top-spacing">
                              <div class="row">
                                <div>
                                  <h6>
                                    <%= __('users.myAccount.label.Team/PositionName') %>
                                  </h6>
                                </div>
                                <div class="row">
                                  <div class="col-6 col-md-4">
                                    <input class="form-control" type="text" name="team" value="<%= user.team %>">
                                  </div>
                                  <div class="col-6 col-md-4">
                                    <input class="form-control" type="text" name="position"
                                      value="<%= user.position %>">
                                  </div>
                                </div>
                              </div>
                            </div>

                            <div class="form-group layout-top-spacing">
                              <div class="row">
                                <div>
                                  <h6>
                                    <%= __('users.myAccount.label.EmailAddress') %>
                                  </h6>
                                </div>
                                <div class="row">
                                  <div class="col-6 col-md-4">
                                    <input class="form-control" type="text" value="<%= user.email %>" disabled>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <div class="form-group layout-top-spacing">
                              <div class="text-center">
                                <button class="btn btn-lg py-3 br-15">
                                  <%= __('users.myAccount.btn.SaveChanges') %>
                                </button>
                              </div>
                            </div>

                        </form>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
            <!--  END CONTENT AREA  -->

            <%- include ("../partials/footer.ejs") %>

        </div>
        <!-- END MAIN CONTAINER -->

        <%- include ("../partials/commonScrpits.ejs") %>

          <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->
          <script>
            let isRemoveImage = false;

            profileImagePath.addEventListener('change', (event) => {
              loadImageFile(event.target, profileImage)
              isRemoveImage = false;
            })

            function removeImage() {
              profileImagePath.value = null;
              profileImage.src = '<%= codezip.url.users.defaultProfileImage %>'
              isRemoveImage = true;
            }

            userAccount.onsubmit = async (e) => {
              e.preventDefault();

              let body = new FormData(userAccount);
              body.append("isRemoveImage", isRemoveImage);

              let response = await fetch(userAccount.action, {
                method: 'POST',
                body: body
              }).then(res => {
                if (res.ok) {
                  alert("<%= __('users.MyAccount.msg.SaveSuccess') %>");
                  window.location.reload();
                }
                else {
                  alert("<%= __('users.MyAccount.msg.SaveFail') %>");
                }
                return res.json();
              }).then(result => {
                console.log(result);
              });
            }

          </script>
          <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->
</body>

</html>